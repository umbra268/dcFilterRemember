!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.dcFilterRememberer=factory()}(this,function(){"use strict";function filterRememberer(){var functions=this,firstRender=!0,originalDcRenderAll=dc.renderAll;dc.renderAll=function(g){if(firstRender){var query_string=window.location.hash.substring(1);query_string.length>0&&functions.applyFilters(functions.decodeFilters(query_string))}originalDcRenderAll(g)},window.onpopstate=function(event){var query_string=window.location.hash.substring(1);dc.filterAll(),query_string.length>0&&functions.applyFilters(functions.decodeFilters(query_string)),dc.redrawAll()},dc.renderlet(function(){var query_string=functions.encodeFilters(functions.getFilters());window.location.hash.substring(1)!=query_string&&(history.pushState?history.pushState(null,null,"#"+query_string):location.hash=query_string)})}function getFilters(){return dc.chartRegistry.list().map(function(chart,index){return{key:index,value:chart.filters()}}).filter(function(o){return o.value.length>0})}function applyFilters(filters){var charts=dc.chartRegistry.list();filters.forEach(function(object){var chart=charts[object.key];object.value.forEach(function(filter){Array.isArray(filter)&&2==filter.length?chart.filter(dc.filters.RangedTwoDimensionalFilter.call(this,filter)):chart.filter(filter)})})}function encodeFilters(filters){return 0===filters.length?"":window.btoa(escape(JSON.stringify(filters)))}function decodeFilters(encodedFilters){return JSON.parse(unescape(window.atob(encodedFilters)))}var version="1.0.0",functions={getFilters:getFilters,encodeFilters:encodeFilters,decodeFilters:decodeFilters,applyFilters:applyFilters},dcFilterRememberer=filterRememberer.bind(functions);return dcFilterRememberer.version=version,Object.keys(functions).forEach(function(key){dcFilterRememberer[key]=function(_){if(!arguments.length)return functions[key];if("function"!=typeof _)throw"[dcFilterRememberer] Unexpected input in getter/setter function";return functions[key]=_,dcFilterRememberer}}),dcFilterRememberer});